
![[Pasted image 20241106200852.png]]
1. Владельцы электронных денег * Агенты эмитента OneVision,
2. Владельцы электронных денег * Субагенты эмитента,
3. Владельцы электронных денег * Физические лица,
4. Владельцы электронных денег * ИП и юридические лица,
5. Наименование системы * Агенты эмитента OneVision,
6. Наименование системы * Субагенты эмитента,
7. Наименование системы * Физические лица,
8. Наименование системы * ИП и юридические лица,
9. Электронные деньги в обращении (тенге) * Агенты эмитента OneVision,
10. Электронные деньги в обращении (тенге) * Субагенты эмитента,
11. Электронные деньги в обращении (тенге) * Физические лица,
12. Электронные деньги в обращении (тенге) * ИП и юридические лица,
13. Количество операций выпуска * Агенты эмитента OneVision,
14. Количество операций выпуска * Субагенты эмитента,
15. Количество операций выпуска * Физические лица,
16. Количество операций выпуска * ИП и юридические лица,
17. Сумма выпуска (тенге) * Агенты эмитента OneVision,
18. Сумма выпуска (тенге) * Субагенты эмитента,
19. Сумма выпуска (тенге) * Физические лица,
20. Сумма выпуска (тенге) * ИП и юридические лица,
21. Количество операций погашения * Агенты эмитента OneVision,
22. Количество операций погашения * Субагенты эмитента,
23. Количество операций погашения * Физические лица,
24. Количество операций погашения * ИП и юридические лица,
25. Сумма погашения (тенге) * Агенты эмитента OneVision,
26. Сумма погашения (тенге) * Субагенты эмитента,
27. Сумма погашения (тенге) * Физические лица,
28. Сумма погашения (тенге) * ИП и юридические лица.


---
### 1–4. Владельцы электронных денег
   - Эти поля содержат текстовые обозначения владельцев.
   - Статичные значения:
     - **1**: "Агенты эмитента OneVision".
     - **2**: "Субагенты эмитента".
     - **3**: "Физические лица" — пользователи с `owner_type = 'physical'`.
     - **4**: "ИП и юридические лица" — пользователи с `owner_type = 'merchant'`.


---
### 5–8. Наименование системы
   - Все строки содержат наименование системы: `"ТОО One Vision"`.
   - Статичные значения для всех четырех ячеек.


---
### 9–12. Электронные деньги в обращении (тенге)
   - Баланс электронных денег для каждой категории владельцев. Для категорий **Физические лица** и **ИП/юридические лица** данные подтягиваются из таблицы `wallets`.
   - **9. Агенты эмитента OneVision**  
     - Если агенты в системе ведутся на счетах, суммируем их баланс, иначе ставим значение `0`.
   - **10. Субагенты эмитента**  
     - Так как субагенты не реализованы, значение равно `0`.
   - **11. Физические лица**  
     - Таблица `wallets`, например:
       ```sql
       SELECT SUM(balance) 
       FROM wallets 
       WHERE owner_type = 'physical';
       ```
   - **12. ИП и юридические лица**  
     - Таблица `wallets`, аналогично:
       ```sql
       SELECT SUM(balance) 
       FROM wallets 
       WHERE owner_type = 'merchant';
       ```


---
### 13–16. Количество операций выпуска
   - Количество операций по выпуску электронных денег (тип транзакции `release`) для каждого типа владельцев.
   - Таблица `transactions`, фильтрация по `operation_type = 'release'`.
   - **13. Агенты эмитента OneVision**  
     - Если транзакции агентов отслеживаются, считаем количество операций, иначе — `0`.
   - **14. Субагенты эмитента**  
     - Поскольку субагентов нет, значение равно `0`.
   - **15. Физические лица**  
     ```sql
     SELECT COUNT(*) 
     FROM transactions 
     WHERE operation_type = 'release' 
       AND owner_type = 'physical'
       AND transaction_date BETWEEN [start_date] AND [end_date];
     ```
   - **16. ИП и юридические лица**  
     ```sql
     SELECT COUNT(*) 
     FROM transactions 
     WHERE operation_type = 'release' 
       AND owner_type = 'merchant'
       AND transaction_date BETWEEN [start_date] AND [end_date];
     ```


---
### 17–20. Сумма выпуска (тенге)
   - Сумма транзакций по выпуску для каждой категории владельцев.
   - Таблица `transactions`, фильтрация по `operation_type = 'release'`.
   - **17. Агенты эмитента OneVision**  
     - Если есть операции выпуска для агентов, суммируем `amount`, иначе — `0`.
   - **18. Субагенты эмитента**  
     - Значение равно `0`, так как субагентов нет.
   - **19. Физические лица**  
     ```sql
     SELECT SUM(amount) 
     FROM transactions 
     WHERE operation_type = 'release' 
       AND owner_type = 'physical'
       AND transaction_date BETWEEN [start_date] AND [end_date];
     ```
   - **20. ИП и юридические лица**  
     ```sql
     SELECT SUM(amount) 
     FROM transactions 
     WHERE operation_type = 'release' 
       AND owner_type = 'merchant'
       AND transaction_date BETWEEN [start_date] AND [end_date];
     ```


---
### 21–24. Количество операций погашения
   - Количество операций по погашению электронных денег (тип транзакции `redemption`) для каждого типа владельцев.
   - Таблица `transactions`, фильтрация по `operation_type = 'redemption'`.
   - **21. Агенты эмитента OneVision**  
     - Если транзакции погашения для агентов ведутся, считаем количество, иначе — `0`.
   - **22. Субагенты эмитента**  
     - Поскольку субагентов нет, значение равно `0`.
   - **23. Физические лица**  
     ```sql
     SELECT COUNT(*) 
     FROM transactions 
     WHERE operation_type = 'redemption' 
       AND owner_type = 'physical'
       AND transaction_date BETWEEN [start_date] AND [end_date];
     ```
   - **24. ИП и юридические лица**  
     ```sql
     SELECT COUNT(*) 
     FROM transactions 
     WHERE operation_type = 'redemption' 
       AND owner_type = 'merchant'
       AND transaction_date BETWEEN [start_date] AND [end_date];
     ```


---
### 25–28. Сумма погашения (тенге)
   - Сумма транзакций по погашению для каждой категории владельцев.
   - Таблица `transactions`, фильтрация по `operation_type = 'redemption'`.
   - **25. Агенты эмитента OneVision**  
     - Если имеются операции погашения для агентов, суммируем `amount`, иначе — `0`.
   - **26. Субагенты эмитента**  
     - Поскольку субагенты не предусмотрены, значение равно `0`.
   - **27. Физические лица**  
     ```sql
     SELECT SUM(amount) 
     FROM transactions 
     WHERE operation_type = 'redemption' 
       AND owner_type = 'physical'
       AND transaction_date BETWEEN [start_date] AND [end_date];
     ```
   - **28. ИП и юридические лица**  
     ```sql
     SELECT SUM(amount) 
     FROM transactions 
     WHERE operation_type = 'redemption' 
       AND owner_type = 'merchant'
       AND transaction_date BETWEEN [start_date] AND [end_date];
     ```
